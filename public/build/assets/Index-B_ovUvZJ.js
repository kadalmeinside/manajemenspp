import{r as j,x as $,k as x,c as d,b as c,d as i,u as g,g as N,w as y,e as t,l as b,t as l,F as k,f as M,n as T,m as E,T as Y,j as B}from"./app-D809bEZJ.js";import{_ as O}from"./SiswaLayout-rVFrY0bR.js";import{P as R}from"./PrimaryButton-C9F_gjTc.js";import{_ as A}from"./Checkbox-zMT8GFc6.js";import{r as L}from"./InformationCircleIcon-Xdeyo1mh.js";import{r as V}from"./CheckCircleIcon-wmTYqoRW.js";import{r as z}from"./CreditCardIcon-BIe7Dc5D.js";import"./ApplicationLogo-BsjCzyT1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DlqpVVTw.js";import"./SecondaryButton-CMc17oHH.js";import"./DangerButton-BSrLnQW_.js";import"./ChevronDownIcon-dvgH7rm3.js";const J={class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},G={class:"py-8"},Z={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},q={key:0,class:"mb-4 p-4 bg-red-100 text-red-700 rounded-md"},H={class:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded-r-lg"},K={class:"flex"},Q={class:"flex-shrink-0"},W={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},X=["onClick"],ee={class:"flex-1"},te={class:"font-medium text-gray-900 dark:text-white"},ae={class:"text-sm text-gray-500 dark:text-gray-400"},se={key:2,class:"text-center text-gray-500 dark:text-gray-400 py-10 bg-white dark:bg-gray-800 rounded-lg shadow-sm"},re={key:0,class:"fixed bottom-0 left-0 right-0 w-full z-40"},oe={class:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm border-t border-gray-200 dark:border-gray-700 shadow-2xl shadow-slate-400/20"},ne={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},ie={class:"flex flex-col sm:flex-row items-center justify-between gap-4"},le={class:"font-semibold text-gray-900 dark:text-white"},de={class:"text-lg font-bold text-red-600 dark:text-red-500"},Te={__name:"Index",props:{sppInvoices:Array,lastPaidPeriod:String,siswa:Object,pageTitle:String,errors:Object},setup(p){const u=p,o=j([]),f=$({periods:[]}),m=x(()=>{if(!u.siswa)return[];const s=u.sppInvoices.map(n=>({...n,is_projected:!1})),r=[];let e;if(s.length>0){const n=new Date(s[s.length-1].periode_tagihan);e=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth()+1,1))}else if(u.lastPaidPeriod){const n=new Date(u.lastPaidPeriod);e=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth()+1,1))}else{const n=new Date;e=new Date(Date.UTC(n.getFullYear(),n.getMonth(),1))}let a=e;const h=new Date(Date.UTC(a.getUTCFullYear(),11,31));for(;a<=h;){const n=a.getUTCFullYear(),U=String(a.getUTCMonth()+1).padStart(2,"0"),v=`${n}-${U}-01`,F=new Intl.DateTimeFormat("id-ID",{month:"long",year:"numeric",timeZone:"UTC"}).format(a),w=u.siswa.jumlah_spp_custom||0;r.push({id:`proj-${v}`,description:`SPP Bulan ${F}`,total_amount:w,total_amount_formatted:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(w),status:"PROJECTED",periode_tagihan:v,is_projected:!0}),a.setUTCMonth(a.getUTCMonth()+1)}return[...s,...r]}),D=x(()=>{if(o.value.length===0)return 0;const s=m.value.filter(e=>o.value.includes(e.periode_tagihan)).reduce((e,a)=>e+a.total_amount,0),r=u.siswa.admin_fee_custom||0;return s+r}),P=x(()=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(D.value)),_=(s,r)=>{const e=m.value.findIndex(a=>a.id===s.id);if(r)(e===0||o.value.includes(m.value[e-1].periode_tagihan))&&o.value.push(s.periode_tagihan);else{const a=m.value.slice(e).map(h=>h.periode_tagihan);o.value=o.value.filter(h=>!a.includes(h))}},C=()=>{f.periods=o.value.sort(),f.post(route("siswa.invoices.unified_pay"),{preserveScroll:!0})},I=s=>({PENDING:"bg-yellow-100 text-yellow-800",PROJECTED:"bg-blue-100 text-blue-800"})[s]||"bg-gray-100 text-gray-800",S=s=>s?s.split("-")[0].trim():"";return(s,r)=>(c(),d(k,null,[i(g(N),{title:p.pageTitle},null,8,["title"]),i(O,null,{header:y(()=>[t("h2",J,l(p.pageTitle),1)]),default:y(()=>[t("div",G,[t("div",Z,[p.errors.error?(c(),d("div",q,l(p.errors.error),1)):b("",!0),t("div",H,[t("div",K,[t("div",Q,[i(g(L),{class:"h-5 w-5 text-yellow-400","aria-hidden":"true"})]),r[0]||(r[0]=t("div",{class:"ml-3"},[t("p",{class:"text-sm text-yellow-700"}," Pilih tagihan yang ingin dibayar. Pembayaran harus dilakukan secara berurutan. ")],-1))])]),m.value.length>0?(c(),d("div",W,[(c(!0),d(k,null,M(m.value,e=>(c(),d("div",{onClick:a=>_(e,!o.value.includes(e.periode_tagihan)),class:T(["bg-white dark:bg-gray-800 rounded-lg shadow-sm transition-all duration-200 mx-2 p-4 flex items-center space-x-4 cursor-pointer hover:shadow-md",{"bg-slate-100 dark:bg-slate-700/50":o.value.includes(e.periode_tagihan)}])},[i(A,{checked:o.value.includes(e.periode_tagihan),"onUpdate:checked":E(a=>_(e,a),["stop"])},null,8,["checked","onUpdate:checked"]),t("div",ee,[t("p",te,l(S(e.description)),1),t("p",ae,l(e.total_amount_formatted),1)]),t("span",{class:T(["px-2 py-0.5 text-xs font-semibold rounded-full",I(e.status)])},l(e.is_projected?"Proyeksi":"Tersedia"),3)],10,X))),256))])):(c(),d("div",se,[i(g(V),{class:"mx-auto h-12 w-12 text-green-400"}),r[1]||(r[1]=t("h4",{class:"mt-2 text-lg font-medium text-gray-900 dark:text-white"},"Semua Lunas!",-1)),r[2]||(r[2]=t("p",null,"Tidak ada tagihan SPP yang perlu dibayar hingga akhir tahun.",-1))])),r[3]||(r[3]=t("div",{class:"pb-24"},null,-1))])]),i(Y,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 translate-y-full","enter-to-class":"transform opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 translate-y-0","leave-to-class":"transform opacity-0 translate-y-full"},{default:y(()=>[o.value.length>0?(c(),d("div",re,[t("div",oe,[t("div",ne,[t("div",ie,[t("div",null,[t("h4",le,l(o.value.length)+" bulan tagihan dipilih",1),t("p",de,l(P.value),1)]),i(R,{onClick:C,disabled:g(f).processing,class:"w-full sm:w-auto"},{default:y(()=>[i(g(z),{class:"h-5 w-5 mr-2"}),B(" "+l(g(f).processing?"Memproses...":"Lanjutkan ke Pembayaran"),1)]),_:1},8,["disabled"])])])])])):b("",!0)]),_:1})]),_:1})],64))}};export{Te as default};
