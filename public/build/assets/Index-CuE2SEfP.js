import{r as F,x as T,k as y,c as d,b as c,d as n,u as m,g as C,w as f,e,l as v,t as l,F as b,f as N,n as w,m as $,T as E,j as O}from"./app-CUVLmLwJ.js";import{_ as M}from"./SiswaLayout-CjxziIjO.js";import{P as R}from"./PrimaryButton-D-ThPLHU.js";import{_ as B}from"./Checkbox-2dv7HbP2.js";import{r as L}from"./InformationCircleIcon-BDtquHRm.js";import{r as V}from"./CheckCircleIcon-DL1tYHsa.js";import{r as A}from"./CreditCardIcon-DnnRxmfs.js";import"./ApplicationLogo-BFD3wm79.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-pYUDCKzy.js";import"./SecondaryButton-B6XGgDl1.js";import"./DangerButton-p9H1-G5f.js";import"./ChevronDownIcon-C75fi-FM.js";const Y={class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},z={class:"py-8"},J={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},U={key:0,class:"mb-4 p-4 bg-red-100 text-red-700 rounded-md"},G={class:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded-r-lg"},q={class:"flex"},H={class:"flex-shrink-0"},K={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},Q=["onClick"],W={class:"flex-1"},X={class:"font-medium text-gray-900 dark:text-white"},Z={class:"text-sm text-gray-500 dark:text-gray-400"},ee={key:2,class:"text-center text-gray-500 dark:text-gray-400 py-10 bg-white dark:bg-gray-800 rounded-lg shadow-sm"},te={key:0,class:"fixed bottom-0 left-0 right-0 w-full z-40"},ae={class:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm border-t border-gray-200 dark:border-gray-700 shadow-2xl shadow-slate-400/20"},se={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},re={class:"flex flex-col sm:flex-row items-center justify-between gap-4"},oe={class:"font-semibold text-gray-900 dark:text-white"},ie={class:"text-lg font-bold text-red-600 dark:text-red-500"},ve={__name:"Index",props:{sppInvoices:Array,siswa:Object,pageTitle:String,errors:Object},setup(p){const g=p,r=F([]),h=T({periods:[]}),u=y(()=>{if(!g.siswa)return[];const a=g.sppInvoices.map(x=>({...x,is_projected:!1})),s=[],t=a.length>0?new Date(a[a.length-1].periode_tagihan):new Date,i=new Date(t.getFullYear(),11,31);let o=new Date(t.getFullYear(),t.getMonth()+1,1);for(;o<=i;){const x=o.toISOString().slice(0,10),j=new Intl.DateTimeFormat("id-ID",{month:"long",year:"numeric"}).format(o);s.push({id:`proj-${x}`,description:`SPP ${j}`,total_amount:g.siswa.jumlah_spp_custom,total_amount_formatted:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(g.siswa.jumlah_spp_custom),status:"PROJECTED",periode_tagihan:x,is_projected:!0}),o.setMonth(o.getMonth()+1)}return[...a,...s]}),k=a=>a?a.split("-")[0].trim():"",D=y(()=>u.value.filter(a=>r.value.includes(a.periode_tagihan)).reduce((a,s)=>a+s.total_amount,0)),I=y(()=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(D.value)),_=(a,s)=>{const t=u.value.findIndex(i=>i.id===a.id);if(s)(t===0||r.value.includes(u.value[t-1].periode_tagihan))&&r.value.push(a.periode_tagihan);else{const i=u.value.slice(t).map(o=>o.periode_tagihan);r.value=r.value.filter(o=>!i.includes(o))}},P=()=>{h.periods=r.value.sort(),h.post(route("siswa.invoices.unified_pay"),{preserveScroll:!0})},S=a=>({PENDING:"bg-yellow-100 text-yellow-800",PROJECTED:"bg-blue-100 text-blue-800"})[a]||"bg-gray-100 text-gray-800";return(a,s)=>(c(),d(b,null,[n(m(C),{title:p.pageTitle},null,8,["title"]),n(M,null,{header:f(()=>[e("h2",Y,l(p.pageTitle),1)]),default:f(()=>[e("div",z,[e("div",J,[p.errors.error?(c(),d("div",U,l(p.errors.error),1)):v("",!0),e("div",G,[e("div",q,[e("div",H,[n(m(L),{class:"h-5 w-5 text-yellow-400","aria-hidden":"true"})]),s[0]||(s[0]=e("div",{class:"ml-3"},[e("p",{class:"text-sm text-yellow-700"}," Pilih tagihan yang ingin dibayar. Pembayaran harus dilakukan secara berurutan. ")],-1))])]),u.value.length>0?(c(),d("div",K,[(c(!0),d(b,null,N(u.value,t=>(c(),d("div",{key:t.id,onClick:i=>_(t,!r.value.includes(t.periode_tagihan)),class:w(["bg-white dark:bg-gray-800 rounded-lg shadow-sm transition-all duration-200 mx-2 p-4 flex items-center space-x-4 cursor-pointer hover:shadow-md",{"bg-indigo-100 dark:bg-indigo-700/50":r.value.includes(t.periode_tagihan)}])},[n(B,{checked:r.value.includes(t.periode_tagihan),"onUpdate:checked":$(i=>_(t,i),["stop"])},null,8,["checked","onUpdate:checked"]),e("div",W,[e("p",X,l(k(t.description)),1),e("p",Z,l(t.total_amount_formatted),1)]),e("span",{class:w(["px-2 py-0.5 text-xs font-semibold rounded-full",S(t.status)])},l((t.is_projected,"")),3)],10,Q))),128))])):(c(),d("div",ee,[n(m(V),{class:"mx-auto h-12 w-12 text-green-400"}),s[1]||(s[1]=e("h4",{class:"mt-2 text-lg font-medium text-gray-900 dark:text-white"},"Semua Lunas!",-1)),s[2]||(s[2]=e("p",null,"Tidak ada tagihan SPP yang perlu dibayar saat ini.",-1))])),s[3]||(s[3]=e("div",{class:"pb-24"},null,-1))])]),n(E,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 translate-y-full","enter-to-class":"transform opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform opacity-100 translate-y-0","leave-to-class":"transform opacity-0 translate-y-full"},{default:f(()=>[r.value.length>0?(c(),d("div",te,[e("div",ae,[e("div",se,[e("div",re,[e("div",null,[e("h4",oe,l(r.value.length)+" bulan tagihan dipilih",1),e("p",ie,l(I.value),1)]),n(R,{onClick:P,disabled:m(h).processing,class:"w-full sm:w-auto"},{default:f(()=>[n(m(A),{class:"h-5 w-5 mr-2"}),O(" "+l(m(h).processing?"Memproses...":"Lanjutkan ke Pembayaran"),1)]),_:1},8,["disabled"])])])])])):v("",!0)]),_:1})]),_:1})],64))}};export{ve as default};
