import{G as K,k as y,r as k,x as O,y as X,o as Y,c as n,b as d,d as a,u as l,g as Z,w as i,e,l as v,h as j,j as c,F as b,f as E,t as p,S as ee,n as D,m as te,Q as M}from"./app-CPVoA31p.js";import{A as se}from"./AuthenticatedLayout-BmzT34Da.js";import{P as B}from"./PrimaryButton-CyS8U3pZ.js";import{_ as U,a as A}from"./SecondaryButton-D-ppne-J.js";import{D as re}from"./DangerButton-BoxGUnk_.js";import{_ as N,a as P}from"./InputLabel-CIQgYFLr.js";import{_ as T}from"./TextInput-ggKNcbCA.js";import{_ as ae}from"./Checkbox-BUPeydpC.js";import{_ as oe}from"./Toast-C8-9R2Dm.js";import{l as le}from"./lodash-zwGhXtpd.js";import{r as de}from"./PlusIcon-npE6ChIn.js";import{r as ne}from"./PencilIcon-B4y1dEeH.js";import{r as ie}from"./TrashIcon-BFGfHL0g.js";import"./ApplicationLogo-DFaQdlNY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-olnXsFbd.js";import"./ArrowPathIcon-C6AM91Xv.js";import"./CheckCircleIcon-DP--bjr8.js";import"./XCircleIcon-DRRMQsRj.js";import"./UsersIcon-CDIMgoQJ.js";import"./XMarkIcon-B4NbLV57.js";import"./ChevronDownIcon-CfmqgwmF.js";import"./ChevronRightIcon-BefVYW0h.js";import"./InformationCircleIcon-CYvSWS7n.js";import"./ExclamationTriangleIcon-U0-XdSvc.js";import"./CheckCircleIcon-Di4KM-L_.js";const me={class:"pb-12 pt-4"},ue={class:"max-w-7xl mx-auto"},ce={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},pe={class:"p-6 text-gray-900 dark:text-gray-100"},ge={class:"mb-6 flex flex-col md:flex-row md:justify-between md:items-center gap-4"},xe={class:"flex flex-col md:flex-row md:justify-between md:items-center gap-4"},fe={class:"flex-grow"},_e={class:"overflow-x-auto"},ye={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ve={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},he={key:0},ke={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300"},we={class:"px-6 py-4 whitespace-normal text-sm text-gray-500 dark:text-gray-300 break-words max-w-xs"},Ce={key:0,class:"text-xs"},Re={key:1,class:"text-xs text-gray-400"},Me={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Se=["onClick"],Ve=["onClick"],$e={key:0,class:"p-4 border-t border-gray-200 dark:border-gray-700"},Ee={class:"flex flex-wrap -mb-1 justify-center"},De=["innerHTML"],Ne={class:"p-6"},Pe={class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4 border-b pb-3 dark:border-gray-700"},Te={key:0},Le={class:"mt-2 grid grid-cols-2 sm:grid-cols-3 gap-x-6 gap-y-3 max-h-60 overflow-y-auto p-2 border dark:border-gray-700 rounded-md"},je={class:"text-sm text-gray-700 dark:text-gray-300"},Be={class:"mt-6 flex justify-end space-x-3 pt-4 border-t dark:border-gray-700"},Ue={class:"p-6"},Ae={class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},Fe={class:"font-semibold"},He={class:"mt-6 flex justify-end space-x-3"},xt={__name:"Index",setup(Ge){const g=K(),m=y(()=>g.props.roles),L=y(()=>g.props.filters||{}),S=y(()=>g.props.allPermissions||[]),V=y(()=>g.props.can||{}),F=y(()=>{var o;return(o=g.props.flash)==null?void 0:o.message}),H=y(()=>{var o;return((o=g.props.flash)==null?void 0:o.type)||"info"}),w=k(!1),x=k(!1),r=O({id:null,name:"",guard_name:"web",permissions:[]}),h=k(L.value.search||""),G=()=>{M.get(route("admin.roles.index"),{search:h.value,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})};X(h,le.debounce(G,300));const Q=()=>{x.value=!1,r.reset(),r.guard_name="web",r.clearErrors(),w.value=!0},W=o=>{x.value=!0,r.reset(),r.clearErrors(),r.id=o.id,r.name=o.name,r.guard_name=o.guard_name,r.permissions=o.permissions?[...o.permissions]:[],w.value=!0},$=()=>{w.value=!1,r.reset(),r.clearErrors()},q=()=>{const o=x.value?route("admin.roles.update",r.id):route("admin.roles.store"),t=x.value?"put":"post";r.submit(t,o,{preserveScroll:!0,onSuccess:()=>{$()},onError:C=>{console.error("Role form submission error:",C)}})},f=k(!1),_=k(null),z=o=>{_.value=o,f.value=!0},I=()=>{_.value&&M.delete(route("admin.roles.destroy",_.value.id),{preserveScroll:!0,onSuccess:()=>{_.value=null,f.value=!1},onError:o=>{console.error("Delete role error:",o),_.value=null,f.value=!1}})};return Y(()=>{const o=new URLSearchParams(window.location.search);h.value=o.get("search")||L.value.search||""}),(o,t)=>(d(),n(b,null,[a(l(Z),{title:"Manage Roles"}),a(se,null,{header:i(()=>t[6]||(t[6]=[e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Role Management",-1)])),default:i(()=>{var C;return[a(oe,{message:F.value,type:H.value},null,8,["message","type"]),e("div",me,[e("div",ue,[e("div",ce,[e("div",pe,[e("div",ge,[e("div",xe,[e("div",fe,[a(T,{type:"text",modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=s=>h.value=s),placeholder:"Search role name...",class:"w-full md:max-w-sm","aria-label":"Search roles"},null,8,["modelValue"])])]),(C=V.value)!=null&&C.create_role?(d(),j(B,{key:0,onClick:Q,class:"w-full md:w-auto mt-2 md:mt-0"},{default:i(()=>[a(l(de),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),t[7]||(t[7]=c(" Add New Role "))]),_:1,__:[7]})):v("",!0)]),e("div",_e,[e("table",ye,[t[9]||(t[9]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Role Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Guard"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Permissions"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ve,[!m.value||!m.value.data||m.value.data.length===0?(d(),n("tr",he,t[8]||(t[8]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400"},"No roles found.",-1)]))):v("",!0),(d(!0),n(b,null,E(m.value.data,s=>{var u,R;return d(),n("tr",{key:s.id},[e("td",ke,p(s.name),1),e("td",be,p(s.guard_name),1),e("td",we,[s.permissions_string&&s.permissions_string.length>0?(d(),n("span",Ce,p(s.permissions_string),1)):(d(),n("span",Re,"No Permissions"))]),e("td",Me,[(u=V.value)!=null&&u.edit_role?(d(),n("button",{key:0,onClick:J=>W(s),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200 p-1 mr-2",title:"Edit Role"},[a(l(ne),{class:"h-5 w-5"})],8,Se)):v("",!0),(R=V.value)!=null&&R.delete_role?(d(),n("button",{key:1,onClick:J=>z(s),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1",title:"Delete Role"},[a(l(ie),{class:"h-5 w-5"})],8,Ve)):v("",!0)])])}),128))])])]),m.value&&m.value.links&&m.value.links.length>3?(d(),n("div",$e,[e("div",Ee,[(d(!0),n(b,null,E(m.value.links,(s,u)=>(d(),n(b,{key:u},[s.url===null?(d(),n("div",{key:0,class:"mr-1 mb-1 px-3 py-2 text-sm leading-4 text-gray-400 dark:text-gray-500 border rounded dark:border-gray-600 select-none",innerHTML:s.label},null,8,De)):(d(),j(l(ee),{key:1,class:D(["mr-1 mb-1 px-3 py-2 text-sm leading-4 border rounded dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600 focus:border-indigo-500 dark:focus:border-indigo-700 focus:text-indigo-500 dark:focus:text-indigo-300",{"bg-indigo-500 text-white dark:bg-indigo-600 dark:text-white dark:border-indigo-700":s.active}]),href:s.url,innerHTML:s.label,"preserve-scroll":""},null,8,["class","href","innerHTML"]))],64))),128))])])):v("",!0)])])])]),a(U,{show:w.value,onClose:$,maxWidth:"2xl"},{default:i(()=>[e("div",Ne,[e("h2",Pe,p(x.value?"Edit Role":"Create New Role"),1),e("form",{onSubmit:te(q,["prevent"]),class:"space-y-6"},[e("div",null,[a(N,{for:"role_name_modal",value:"Role Name"}),a(T,{id:"role_name_modal",type:"text",class:"mt-1 block w-full",modelValue:l(r).name,"onUpdate:modelValue":t[1]||(t[1]=s=>l(r).name=s),required:"",autofocus:""},null,8,["modelValue"]),a(P,{class:"mt-2",message:l(r).errors.name},null,8,["message"])]),e("div",null,[a(N,{for:"role_guard_name_modal",value:"Guard Name (e.g., web, api)"}),a(T,{id:"role_guard_name_modal",type:"text",class:"mt-1 block w-full",modelValue:l(r).guard_name,"onUpdate:modelValue":t[2]||(t[2]=s=>l(r).guard_name=s),placeholder:"web"},null,8,["modelValue"]),a(P,{class:"mt-2",message:l(r).errors.guard_name},null,8,["message"])]),S.value&&S.value.length>0?(d(),n("div",Te,[a(N,{value:"Permissions",class:"mb-1"}),e("div",Le,[(d(!0),n(b,null,E(S.value,(s,u)=>(d(),n("label",{key:"perm_opt_"+u,class:"flex items-center space-x-2 cursor-pointer"},[a(ae,{id:"permission_modal_"+u,value:s,checked:l(r).permissions,"onUpdate:checked":t[3]||(t[3]=R=>l(r).permissions=R)},null,8,["id","value","checked"]),e("span",je,p(s.replace(/_/g," ")),1)]))),128))]),a(P,{class:"mt-2",message:l(r).errors.permissions},null,8,["message"])])):v("",!0),e("div",Be,[a(A,{onClick:$,type:"button"},{default:i(()=>t[10]||(t[10]=[c(" Cancel ")])),_:1,__:[10]}),a(B,{class:D({"opacity-25":l(r).processing}),disabled:l(r).processing},{default:i(()=>[c(p(x.value?"Update Role":"Create Role"),1)]),_:1},8,["class","disabled"])])],32)])]),_:1},8,["show"]),a(U,{show:f.value,onClose:t[5]||(t[5]=s=>f.value=!1),maxWidth:"md"},{default:i(()=>{var s;return[e("div",Ue,[t[15]||(t[15]=e("h2",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Confirm Delete Role ",-1)),e("p",Ae,[t[11]||(t[11]=c(' Are you sure you want to delete role "')),e("span",Fe,p((s=_.value)==null?void 0:s.name),1),t[12]||(t[12]=c('"? This action cannot be undone. '))]),e("div",He,[a(A,{onClick:t[4]||(t[4]=u=>f.value=!1),type:"button"},{default:i(()=>t[13]||(t[13]=[c(" Cancel ")])),_:1,__:[13]}),a(re,{onClick:I,class:D({"opacity-25":l(M).processing||l(r).processing}),disabled:l(M).processing||l(r).processing},{default:i(()=>t[14]||(t[14]=[c(" Delete Role ")])),_:1,__:[14]},8,["class","disabled"])])])]}),_:1},8,["show"])]}),_:1})],64))}};export{xt as default};
