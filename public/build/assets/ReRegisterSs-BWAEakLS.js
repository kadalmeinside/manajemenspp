import{x as C,r as S,c as i,b as n,d as t,u as a,g as q,w,l as b,e as r,t as u,j as m,S as D,m as $,C as L,F as x,f as N,D as T,n as v}from"./app-PnW9LIMI.js";import{_ as B}from"./FormPageLayout-CfJzQhdJ.js";import{P as h}from"./PrimaryButton-BY0ysqHt.js";import{a as M,_ as W}from"./SecondaryButton-n7TCxxEi.js";import{_ as p,a as _,b as g}from"./TextInput-BN2en4en.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={key:0,class:"absolute inset-0 bg-white/80 dark:bg-gray-900/80 z-50 flex flex-col items-center justify-center"},A={key:1,class:"text-center"},I={class:"mt-4 text-2xl font-semibold text-gray-900 dark:text-white"},U={class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},K={class:"mt-6 p-4 border rounded-lg bg-gray-50 dark:bg-gray-900 text-left"},z={class:"mt-2 space-y-2 text-sm text-gray-700 dark:text-gray-300"},H={class:"mt-8"},O={key:0,class:"p-4 bg-red-100 text-red-700 rounded-md"},F={class:"border-t border-gray-200 dark:border-gray-700 pt-6"},R={class:"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8"},G={class:"sm:col-span-2"},J=["value"],Q={class:"border-t border-gray-200 dark:border-gray-700 pt-6"},X={class:"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8"},Y={class:"sm:col-span-2"},Z={class:"border-t border-gray-200 dark:border-gray-700 pt-6"},ee={class:"mt-6"},se={key:0,class:"h-3 w-3 text-white",fill:"none",viewBox:"0 0 24 24","stroke-width":"3",stroke:"currentColor"},re={class:"pt-5 flex justify-end"},ae={key:0},te={key:1},le={class:"p-6"},oe={key:0,class:"text-xs"},ie=["innerHTML"],ne={key:2,class:"mt-4 text-red-500"},de={class:"mt-6 flex justify-end space-x-3 border-t border-gray-200 dark:border-gray-700 pt-4"},_e={__name:"ReRegisterSs",props:{pageTitle:String,allKelas:Array,termsDocument:Object,errors:Object,flash:Object},setup(d){var c;const f=d,s=C({nama_siswa:"",tanggal_lahir:"",id_kelas:"",user_name:"",email_wali:"",nomor_telepon_wali:"",user_password:"",user_password_confirmation:"",terms:!1,legal_document_id:((c=f.termsDocument)==null?void 0:c.id)||null}),k=S(!1),V=o=>{s.terms&&o.target.tagName.toLowerCase()!=="button"||(k.value=!0)},j=()=>{s.terms=!0,k.value=!1},E=()=>{s.clearErrors();let o=!1;s.nama_siswa||(s.setError("nama_siswa","Nama Lengkap Siswa wajib diisi."),o=!0),s.tanggal_lahir||(s.setError("tanggal_lahir","Tanggal Lahir wajib diisi."),o=!0),s.id_kelas||(s.setError("id_kelas","Silakan pilih cabang/kelas."),o=!0),s.user_name||(s.setError("user_name","Nama Lengkap Wali wajib diisi."),o=!0),s.email_wali||(s.setError("email_wali","Alamat Email Wali wajib diisi."),o=!0),s.nomor_telepon_wali||(s.setError("nomor_telepon_wali","Nomor WhatsApp Wali wajib diisi."),o=!0),s.user_password||(s.setError("user_password","Password wajib diisi."),o=!0),s.user_password&&s.user_password!==s.user_password_confirmation&&(s.setError("user_password_confirmation","Konfirmasi password tidak cocok."),o=!0),s.terms||(s.setError("terms","Anda harus menyetujui syarat dan ketentuan."),o=!0),!o&&s.post(route("re-register.store"),{onError:()=>{s.reset("user_password","user_password_confirmation")}})};return(o,e)=>(n(),i(x,null,[t(a(q),{title:d.pageTitle},null,8,["title"]),t(B,null,{header:w(()=>[m(u(d.pageTitle),1)]),default:w(()=>{var y;return[a(s).processing?(n(),i("div",P,e[18]||(e[18]=[r("svg",{class:"animate-spin h-10 w-10 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),r("p",{class:"mt-4 text-lg font-medium text-gray-700 dark:text-gray-300"},"Memproses Pendaftaran...",-1)]))):b("",!0),(y=f.flash)!=null&&y.success?(n(),i("div",A,[e[26]||(e[26]=r("svg",{class:"mx-auto h-16 w-16 text-green-500",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),r("h3",I,u(f.flash.message),1),r("p",U,[e[19]||(e[19]=m(" Email konfirmasi berisi detail pendaftaran telah dikirim ke ")),r("strong",null,u(f.flash.completed_data.email_wali),1),e[20]||(e[20]=m(". "))]),r("div",K,[e[24]||(e[24]=r("h4",{class:"font-medium text-gray-800 dark:text-gray-200"},"Detail Pendaftaran:",-1)),r("ul",z,[r("li",null,[e[21]||(e[21]=r("strong",null,"NIS Baru:",-1)),m(" "+u(f.flash.completed_data.nis),1)]),r("li",null,[e[22]||(e[22]=r("strong",null,"Nama Siswa:",-1)),m(" "+u(f.flash.completed_data.nama_siswa),1)]),r("li",null,[e[23]||(e[23]=r("strong",null,"Nama Wali:",-1)),m(" "+u(f.flash.completed_data.nama_wali),1)])])]),r("div",H,[t(a(D),{href:o.route("login"),class:"inline-flex items-center justify-center rounded-md border border-transparent bg-red-600 px-6 py-3 text-base font-medium text-white shadow-sm hover:bg-red-700"},{default:w(()=>e[25]||(e[25]=[m(" Lanjut ke Halaman Login ")])),_:1,__:[25]},8,["href"])])])):(n(),i("form",{key:2,onSubmit:$(E,["prevent"]),novalidate:"",class:"space-y-6"},[d.errors.general?(n(),i("div",O,u(d.errors.general),1)):b("",!0),r("fieldset",F,[e[28]||(e[28]=r("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"1. Data Diri Siswa",-1)),r("div",R,[r("div",G,[t(p,{for:"nama_siswa",value:"Nama Lengkap Siswa",required:""}),t(_,{id:"nama_siswa",modelValue:a(s).nama_siswa,"onUpdate:modelValue":e[0]||(e[0]=l=>a(s).nama_siswa=l),onInput:e[1]||(e[1]=l=>a(s).clearErrors("nama_siswa")),type:"text",class:"mt-1 block w-full",placeholder:"Cth: Budi Santoso",required:""},null,8,["modelValue"]),t(g,{message:a(s).errors.nama_siswa,class:"mt-2"},null,8,["message"])]),r("div",null,[t(p,{for:"tanggal_lahir",value:"Tanggal Lahir",required:""}),t(_,{id:"tanggal_lahir",modelValue:a(s).tanggal_lahir,"onUpdate:modelValue":e[2]||(e[2]=l=>a(s).tanggal_lahir=l),onInput:e[3]||(e[3]=l=>a(s).clearErrors("tanggal_lahir")),type:"date",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(g,{message:a(s).errors.tanggal_lahir,class:"mt-2"},null,8,["message"])]),r("div",null,[t(p,{for:"id_kelas",value:"Pilih Cabang/Kelas",required:""}),L(r("select",{id:"id_kelas","onUpdate:modelValue":e[4]||(e[4]=l=>a(s).id_kelas=l),onChange:e[5]||(e[5]=l=>a(s).clearErrors("id_kelas")),class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[e[27]||(e[27]=r("option",{value:"",disabled:""},"-- Pilih Cabang --",-1)),(n(!0),i(x,null,N(d.allKelas,l=>(n(),i("option",{key:l.id_kelas,value:l.id_kelas},u(l.nama_kelas),9,J))),128))],544),[[T,a(s).id_kelas]]),t(g,{message:a(s).errors.id_kelas,class:"mt-2"},null,8,["message"])])])]),r("fieldset",Q,[e[29]||(e[29]=r("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"2. Data Wali & Akun Login",-1)),r("div",X,[r("div",null,[t(p,{for:"user_name",value:"Nama Lengkap Wali",required:""}),t(_,{id:"user_name",modelValue:a(s).user_name,"onUpdate:modelValue":e[6]||(e[6]=l=>a(s).user_name=l),onInput:e[7]||(e[7]=l=>a(s).clearErrors("user_name")),type:"text",class:"mt-1 block w-full",placeholder:"Cth: Ayah Budi",required:""},null,8,["modelValue"]),t(g,{message:a(s).errors.user_name,class:"mt-2"},null,8,["message"])]),r("div",null,[t(p,{for:"nomor_telepon_wali",value:"Nomor WhatsApp Wali",required:""}),t(_,{id:"nomor_telepon_wali",modelValue:a(s).nomor_telepon_wali,"onUpdate:modelValue":e[8]||(e[8]=l=>a(s).nomor_telepon_wali=l),onInput:e[9]||(e[9]=l=>a(s).clearErrors("nomor_telepon_wali")),type:"tel",class:"mt-1 block w-full",placeholder:"Cth: 081234567890",required:""},null,8,["modelValue"]),t(g,{message:a(s).errors.nomor_telepon_wali,class:"mt-2"},null,8,["message"])]),r("div",Y,[t(p,{for:"email_wali",value:"Alamat Email Wali (untuk login)",required:""}),t(_,{id:"email_wali",modelValue:a(s).email_wali,"onUpdate:modelValue":e[10]||(e[10]=l=>a(s).email_wali=l),onInput:e[11]||(e[11]=l=>a(s).clearErrors("email_wali")),type:"email",class:"mt-1 block w-full",placeholder:"Cth: wali.budi@email.com",required:""},null,8,["modelValue"]),t(g,{message:a(s).errors.email_wali,class:"mt-2"},null,8,["message"])]),r("div",null,[t(p,{for:"user_password",value:"Buat Password",required:""}),t(_,{id:"user_password",modelValue:a(s).user_password,"onUpdate:modelValue":e[12]||(e[12]=l=>a(s).user_password=l),onInput:e[13]||(e[13]=l=>a(s).clearErrors("user_password")),type:"password",class:"mt-1 block w-full",placeholder:"••••••••",required:""},null,8,["modelValue"]),t(g,{message:a(s).errors.user_password,class:"mt-2"},null,8,["message"])]),r("div",null,[t(p,{for:"user_password_confirmation",value:"Konfirmasi Password",required:""}),t(_,{id:"user_password_confirmation",modelValue:a(s).user_password_confirmation,"onUpdate:modelValue":e[14]||(e[14]=l=>a(s).user_password_confirmation=l),onInput:e[15]||(e[15]=l=>a(s).clearErrors("user_password_confirmation")),type:"password",class:"mt-1 block w-full",placeholder:"••••••••",required:""},null,8,["modelValue"]),t(g,{message:a(s).errors.user_password_confirmation,class:"mt-2"},null,8,["message"])])])]),r("fieldset",Z,[e[32]||(e[32]=r("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"3. Persetujuan",-1)),r("div",ee,[r("div",{onClick:V,class:"flex items-center cursor-pointer group"},[r("div",{class:v(["h-4 w-4 rounded border flex items-center justify-center transition-all",a(s).terms?"bg-red-600 border-red-700":"bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600 group-hover:border-red-500"])},[a(s).terms?(n(),i("svg",se,e[30]||(e[30]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"},null,-1)]))):b("",!0)],2),e[31]||(e[31]=r("span",{class:"ml-3 text-sm text-gray-600 dark:text-gray-400"},[m(" Saya menyetujui "),r("button",{type:"button",class:"font-medium text-red-600 hover:underline"},"syarat dan ketentuan"),m(" yang berlaku. ")],-1))]),t(g,{message:a(s).errors.terms||a(s).errors.legal_document_id,class:"mt-2"},null,8,["message"])])]),r("div",re,[t(h,{class:v(["w-full justify-center text-lg bg-red-600 hover:bg-red-700 focus:ring-red-500",{"opacity-50 cursor-not-allowed":!a(s).terms}]),disabled:a(s).processing||!a(s).terms},{default:w(()=>[a(s).processing?(n(),i("span",ae,"Menyimpan...")):(n(),i("span",te,"Simpan Data Siswa"))]),_:1},8,["disabled","class"])])],32))]}),_:1}),t(W,{show:k.value,onClose:e[17]||(e[17]=y=>k.value=!1),maxWidth:"2xl"},{default:w(()=>[r("div",le,[e[35]||(e[35]=r("h2",{class:"text-xl font-bold text-gray-900 dark:text-white"},"Syarat dan Ketentuan",-1)),d.termsDocument?(n(),i("div",oe,u(d.termsDocument.name)+" (v"+u(d.termsDocument.version)+")",1)):b("",!0),d.termsDocument?(n(),i("div",{key:1,class:"mt-4 prose prose-sm max-w-none text-gray-600 dark:text-gray-300 overflow-y-auto max-h-[60vh]",innerHTML:d.termsDocument.content},null,8,ie)):(n(),i("div",ne,"Gagal memuat Syarat & Ketentuan. Silakan coba lagi nanti.")),r("div",de,[t(M,{onClick:e[16]||(e[16]=y=>k.value=!1)},{default:w(()=>e[33]||(e[33]=[m("Tidak Setuju")])),_:1,__:[33]}),t(h,{onClick:j,class:"bg-red-600 hover:bg-red-700 focus:ring-red-500",disabled:!d.termsDocument},{default:w(()=>e[34]||(e[34]=[m("Setuju")])),_:1,__:[34]},8,["disabled"])])])]),_:1},8,["show"])],64))}};export{_e as default};
