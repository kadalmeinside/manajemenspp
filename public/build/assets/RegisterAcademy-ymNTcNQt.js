import{G as H,k as S,x as I,r as g,c as n,b as o,d as l,u as t,g as O,w,l as p,e as a,m as G,t as i,C as R,D as J,n as P,h as Q,j as V,F as X,K as Y}from"./app-PnW9LIMI.js";import{_ as Z}from"./FormPageLayout-CfJzQhdJ.js";import{P as U}from"./PrimaryButton-BY0ysqHt.js";import{a as L,_ as ee}from"./SecondaryButton-n7TCxxEi.js";import{_ as m,a as y,b as c}from"./TextInput-BN2en4en.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={key:0,class:"absolute inset-0 bg-white/80 dark:bg-gray-900/80 z-50 flex flex-col items-center justify-center"},se={key:0,class:"p-4 bg-red-100 text-red-700 rounded-md"},te={class:"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8"},le={class:"sm:col-span-2"},re=["value"],oe={class:"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8"},ne={class:"sm:col-span-2"},de={class:"mt-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg space-y-3"},ie={class:"flex justify-between items-center text-gray-600 dark:text-gray-300"},ue={key:0,class:"flex justify-between items-center text-green-600 dark:text-green-400"},me={key:1,class:"flex justify-between items-center text-green-600 dark:text-green-400"},ce={class:"flex justify-between items-center text-xl font-bold text-gray-900 dark:text-white pt-3 border-t border-gray-200 dark:border-gray-700"},ge={class:"text-red-600"},pe={class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},ye={class:"mt-1 flex gap-2"},fe={key:0},ve={key:1},_e={class:"mt-6"},ke={key:0,class:"h-3 w-3 text-white",fill:"none",viewBox:"0 0 24 24","stroke-width":"3",stroke:"currentColor"},xe={class:"pt-5 flex justify-end"},we={key:0},be={key:1},he={class:"p-6"},Ve={key:0,class:"text-xs"},Ce=["innerHTML"],De={key:2,class:"mt-4 text-red-500"},je={class:"mt-6 flex justify-end space-x-3 border-t border-gray-200 dark:border-gray-700 pt-4"},Ne={__name:"RegisterAcademy",props:{pageTitle:String,academyClass:Object,termsDocument:Object,errors:Object},setup(d){var M,N;const f=d,$=H(),A=S(()=>$.props.flash),s=I({nama_siswa:"",tanggal_lahir:"",id_kelas:((M=f.academyClass)==null?void 0:M.id_kelas)||null,user_name:"",email_wali:"",nomor_telepon_wali:"",user_password:"",user_password_confirmation:"",terms:!1,legal_document_id:((N=f.termsDocument)==null?void 0:N.id)||null,kode_promo:""}),B=g(f.academyClass.biaya_pendaftaran_normal),C=g(f.academyClass.biaya_pendaftaran_saat_ini),b=g(f.academyClass.biaya_pendaftaran_saat_ini),v=g(""),D=g(!1),_=g({type:"",text:""}),k=g(null),h=g(!1),j=x=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(x),q=S(()=>B.value-C.value),T=S(()=>k.value?C.value-b.value:0),K=async()=>{var x,e;if(v.value){D.value=!0,_.value={type:"",text:""},s.clearErrors("kode_promo");try{const u=await Y.post(route("promo.validate"),{id_kelas:s.id_kelas,kode_promo:v.value});b.value=u.data.new_price,s.kode_promo=v.value,k.value={name:`Diskon Kode '${v.value.toUpperCase()}'`},_.value={type:"success",text:u.data.message}}catch(u){b.value=C.value,s.kode_promo="",k.value=null,_.value={type:"error",text:((e=(x=u.response)==null?void 0:x.data)==null?void 0:e.message)||"Terjadi kesalahan."}}finally{D.value=!1}}},W=()=>{b.value=C.value,v.value="",s.kode_promo="",_.value={type:"",text:""},k.value=null},z=x=>{s.terms&&x.target.tagName.toLowerCase()!=="button"||(h.value=!0)},E=()=>{s.terms=!0,h.value=!1},F=()=>{s.post(route("pendaftaran.store"),{onError:()=>s.reset("user_password","user_password_confirmation")})};return(x,e)=>(o(),n(X,null,[l(t(O),{title:d.pageTitle},null,8,["title"]),l(Z,null,{header:w(()=>[V(i(d.pageTitle),1)]),default:w(()=>{var u;return[t(s).processing?(o(),n("div",ae,e[11]||(e[11]=[a("svg",{class:"animate-spin h-10 w-10 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),a("p",{class:"mt-4 text-lg font-medium text-gray-700 dark:text-gray-300"},"Memproses Pendaftaran...",-1)]))):p("",!0),(u=A.value)!=null&&u.success?p("",!0):(o(),n("form",{key:1,onSubmit:G(F,["prevent"]),novalidate:"",class:"space-y-8"},[d.errors.general?(o(),n("div",se,i(d.errors.general),1)):p("",!0),a("fieldset",null,[e[12]||(e[12]=a("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"1. Data Diri Siswa",-1)),a("div",te,[a("div",le,[l(m,{for:"nama_siswa",value:"Nama Lengkap Siswa",required:""}),l(y,{id:"nama_siswa",modelValue:t(s).nama_siswa,"onUpdate:modelValue":e[0]||(e[0]=r=>t(s).nama_siswa=r),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:t(s).errors.nama_siswa,class:"mt-2"},null,8,["message"])]),a("div",null,[l(m,{for:"tanggal_lahir",value:"Tanggal Lahir",required:""}),l(y,{id:"tanggal_lahir",modelValue:t(s).tanggal_lahir,"onUpdate:modelValue":e[1]||(e[1]=r=>t(s).tanggal_lahir=r),type:"date",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:t(s).errors.tanggal_lahir,class:"mt-2"},null,8,["message"])]),a("div",null,[l(m,{for:"id_kelas",value:"Kelas Akademi"}),R(a("select",{id:"id_kelas","onUpdate:modelValue":e[2]||(e[2]=r=>t(s).id_kelas=r),class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 rounded-md shadow-sm",disabled:""},[a("option",{value:f.academyClass.id_kelas},i(f.academyClass.nama_kelas),9,re)],512),[[J,t(s).id_kelas]]),l(c,{message:t(s).errors.id_kelas,class:"mt-2"},null,8,["message"])])])]),a("fieldset",null,[e[13]||(e[13]=a("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"2. Data Wali & Akun Login",-1)),a("div",oe,[a("div",null,[l(m,{for:"user_name",value:"Nama Lengkap Wali",required:""}),l(y,{id:"user_name",modelValue:t(s).user_name,"onUpdate:modelValue":e[3]||(e[3]=r=>t(s).user_name=r),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:t(s).errors.user_name,class:"mt-2"},null,8,["message"])]),a("div",null,[l(m,{for:"nomor_telepon_wali",value:"Nomor WhatsApp Wali",required:""}),l(y,{id:"nomor_telepon_wali",modelValue:t(s).nomor_telepon_wali,"onUpdate:modelValue":e[4]||(e[4]=r=>t(s).nomor_telepon_wali=r),type:"tel",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:t(s).errors.nomor_telepon_wali,class:"mt-2"},null,8,["message"])]),a("div",ne,[l(m,{for:"email_wali",value:"Alamat Email Wali (untuk login)",required:""}),l(y,{id:"email_wali",modelValue:t(s).email_wali,"onUpdate:modelValue":e[5]||(e[5]=r=>t(s).email_wali=r),type:"email",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:t(s).errors.email_wali,class:"mt-2"},null,8,["message"])]),a("div",null,[l(m,{for:"user_password",value:"Buat Password",required:""}),l(y,{id:"user_password",modelValue:t(s).user_password,"onUpdate:modelValue":e[6]||(e[6]=r=>t(s).user_password=r),type:"password",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:t(s).errors.user_password,class:"mt-2"},null,8,["message"])]),a("div",null,[l(m,{for:"user_password_confirmation",value:"Konfirmasi Password",required:""}),l(y,{id:"user_password_confirmation",modelValue:t(s).user_password_confirmation,"onUpdate:modelValue":e[7]||(e[7]=r=>t(s).user_password_confirmation=r),type:"password",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:t(s).errors.user_password_confirmation,class:"mt-2"},null,8,["message"])])])]),a("fieldset",null,[e[17]||(e[17]=a("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"3. Biaya Pendaftaran",-1)),a("div",de,[a("div",ie,[e[14]||(e[14]=a("span",null,"Biaya Pendaftaran Normal",-1)),a("span",{class:P({"line-through text-gray-500":q.value>0||T.value>0})},i(j(B.value)),3)]),q.value>0?(o(),n("div",ue,[e[15]||(e[15]=a("span",null,"Diskon Pendaftaran",-1)),a("span",null,"- "+i(j(q.value)),1)])):p("",!0),T.value>0?(o(),n("div",me,[a("span",null,i(k.value.name),1),a("span",null,"- "+i(j(T.value)),1)])):p("",!0),a("div",ce,[e[16]||(e[16]=a("span",null,"Total Biaya",-1)),a("span",ge,i(j(b.value)),1)]),a("div",pe,[l(m,{for:"kode_promo",value:"Punya Kode Promo?"}),a("div",ye,[l(y,{id:"kode_promo",modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=r=>v.value=r),type:"text",class:"block w-full",placeholder:"Masukkan kode di sini",disabled:!!k.value},null,8,["modelValue","disabled"]),k.value?(o(),n("button",{key:1,onClick:W,type:"button",class:"text-sm font-medium text-red-600 hover:text-red-500"},"Hapus")):(o(),Q(L,{key:0,onClick:K,disabled:D.value,type:"button"},{default:w(()=>[D.value?(o(),n("span",ve,"...")):(o(),n("span",fe,"Terapkan"))]),_:1},8,["disabled"]))]),_.value.text?(o(),n("p",{key:0,class:P(["mt-2 text-sm",_.value.type==="success"?"text-green-600":"text-red-600"])},i(_.value.text),3)):p("",!0)])])]),a("fieldset",null,[e[20]||(e[20]=a("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"4. Persetujuan",-1)),a("div",_e,[a("div",{onClick:z,class:"flex items-center cursor-pointer group"},[a("div",{class:P(["h-4 w-4 rounded border flex items-center justify-center transition-all",t(s).terms?"bg-red-600 border-red-700":"bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600 group-hover:border-red-500"])},[t(s).terms?(o(),n("svg",ke,e[18]||(e[18]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"},null,-1)]))):p("",!0)],2),e[19]||(e[19]=a("span",{class:"ml-3 text-sm text-gray-600 dark:text-gray-400"},[V(" Saya menyetujui "),a("button",{type:"button",class:"font-medium text-red-600 hover:underline"},"syarat dan ketentuan"),V(" yang berlaku. ")],-1))]),l(c,{message:t(s).errors.terms||t(s).errors.legal_document_id,class:"mt-2"},null,8,["message"])])]),a("div",xe,[l(U,{class:P(["w-full justify-center text-lg",{"opacity-50 cursor-not-allowed":!t(s).terms}]),disabled:t(s).processing||!t(s).terms},{default:w(()=>[t(s).processing?(o(),n("span",we,"Menyimpan...")):(o(),n("span",be,"Daftar & Lanjutkan Pembayaran"))]),_:1},8,["disabled","class"])])],32))]}),_:1}),l(ee,{show:h.value,onClose:e[10]||(e[10]=u=>h.value=!1),maxWidth:"2xl"},{default:w(()=>[a("div",he,[e[23]||(e[23]=a("h2",{class:"text-xl font-bold text-gray-900 dark:text-white"},"Syarat dan Ketentuan",-1)),d.termsDocument?(o(),n("div",Ve,i(d.termsDocument.name)+" (v"+i(d.termsDocument.version)+")",1)):p("",!0),d.termsDocument?(o(),n("div",{key:1,class:"mt-4 prose prose-sm max-w-none text-gray-600 dark:text-gray-300 overflow-y-auto max-h-[60vh]",innerHTML:d.termsDocument.content},null,8,Ce)):(o(),n("div",De,"Gagal memuat Syarat & Ketentuan.")),a("div",je,[l(L,{onClick:e[9]||(e[9]=u=>h.value=!1)},{default:w(()=>e[21]||(e[21]=[V("Tidak Setuju")])),_:1,__:[21]}),l(U,{onClick:E,class:"bg-red-600 hover:bg-red-700 focus:ring-red-500",disabled:!d.termsDocument},{default:w(()=>e[22]||(e[22]=[V("Setuju")])),_:1,__:[22]},8,["disabled"])])])]),_:1},8,["show"])],64))}};export{Ne as default};
