import{G as I,k as j,x as O,r as _,y as G,c as n,b as o,d as l,u as s,g as R,w as x,l as g,e as t,m as J,t as u,C as Q,F as N,f as X,D as Y,n as P,h as Z,j as V,K as ee}from"./app-D_KT0tPu.js";import{_ as ae}from"./FormPageLayout-BqR6fzNW.js";import{P as L}from"./PrimaryButton-cD5W__y6.js";import{a as U,_ as te}from"./SecondaryButton-BiNkEi16.js";import{_ as p,a as k,b as c}from"./TextInput-BfGu2Bmr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const se={key:0,class:"absolute inset-0 bg-white/80 dark:bg-gray-900/80 z-50 flex flex-col items-center justify-center"},le={key:0,class:"p-4 bg-red-100 text-red-700 rounded-md"},re={class:"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8"},oe={class:"sm:col-span-2"},ne=["value"],ie={class:"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8"},de={class:"sm:col-span-2"},ue={key:1},me={class:"mt-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg space-y-3"},ge={class:"flex justify-between items-center text-gray-600 dark:text-gray-300"},pe={key:0,class:"flex justify-between items-center text-green-600 dark:text-green-400"},ce={key:1,class:"flex justify-between items-center text-green-600 dark:text-green-400"},fe={class:"flex justify-between items-center text-xl font-bold text-gray-900 dark:text-white pt-3 border-t border-gray-200 dark:border-gray-700"},ye={class:"text-red-600"},ve={class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},_e={class:"mt-1 flex gap-2"},ke={key:0},xe={key:1},we={class:"mt-6"},be={key:0,class:"h-3 w-3 text-white",fill:"none",viewBox:"0 0 24 24","stroke-width":"3",stroke:"currentColor"},he={class:"pt-5 flex justify-end"},Ve={key:0},Ce={key:1},De={class:"p-6"},je={key:0,class:"text-xs"},Pe=["innerHTML"],qe={key:2,class:"mt-4 text-red-500"},Se={class:"mt-6 flex justify-end space-x-3 border-t border-gray-200 dark:border-gray-700 pt-4"},$e={__name:"RegisterSs",props:{pageTitle:String,allKelas:Array,termsDocument:Object,errors:Object},setup(d){var M;const B=d,$=I(),K=j(()=>$.props.flash),a=O({nama_siswa:"",tanggal_lahir:"",id_kelas:"",user_name:"",email_wali:"",nomor_telepon_wali:"",user_password:"",user_password_confirmation:"",terms:!1,legal_document_id:((M=B.termsDocument)==null?void 0:M.id)||null,kode_promo:""}),q=_(0),b=_(0),w=_(0),f=_(""),C=_(!1),y=_({type:"",text:""}),v=_(null),h=_(!1),A=j(()=>B.allKelas.find(i=>i.id_kelas===a.id_kelas));G(A,i=>{i&&(q.value=i.biaya_pendaftaran_normal,b.value=i.biaya_pendaftaran_saat_ini,w.value=i.biaya_pendaftaran_saat_ini,f.value="",a.kode_promo="",y.value={type:"",text:""},v.value=null)});const D=i=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(i),S=j(()=>q.value-b.value),T=j(()=>v.value?b.value-w.value:0),W=async()=>{var i,e;if(!(!f.value||!a.id_kelas)){C.value=!0,y.value={type:"",text:""},a.clearErrors("kode_promo");try{const m=await ee.post(route("promo.validate"),{id_kelas:a.id_kelas,kode_promo:f.value});w.value=m.data.new_price,a.kode_promo=f.value,v.value={name:`Diskon Kode '${f.value.toUpperCase()}'`},y.value={type:"success",text:m.data.message}}catch(m){w.value=b.value,a.kode_promo="",v.value=null,y.value={type:"error",text:((e=(i=m.response)==null?void 0:i.data)==null?void 0:e.message)||"Terjadi kesalahan."}}finally{C.value=!1}}},z=()=>{w.value=b.value,f.value="",a.kode_promo="",y.value={type:"",text:""},v.value=null},E=i=>{a.terms&&i.target.tagName.toLowerCase()!=="button"||(h.value=!0)},F=()=>{a.terms=!0,h.value=!1},H=()=>{a.post(route("pendaftaran.store"),{onError:()=>a.reset("user_password","user_password_confirmation")})};return(i,e)=>(o(),n(N,null,[l(s(R),{title:d.pageTitle},null,8,["title"]),l(ae,null,{header:x(()=>[V(u(d.pageTitle),1)]),default:x(()=>{var m;return[s(a).processing?(o(),n("div",se,e[11]||(e[11]=[t("svg",{class:"animate-spin h-10 w-10 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),t("p",{class:"mt-4 text-lg font-medium text-gray-700 dark:text-gray-300"},"Memproses Pendaftaran...",-1)]))):g("",!0),(m=K.value)!=null&&m.success?g("",!0):(o(),n("form",{key:1,onSubmit:J(H,["prevent"]),novalidate:"",class:"space-y-8"},[d.errors.general?(o(),n("div",le,u(d.errors.general),1)):g("",!0),t("fieldset",null,[e[13]||(e[13]=t("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"1. Data Diri Siswa",-1)),t("div",re,[t("div",oe,[l(p,{for:"nama_siswa",value:"Nama Lengkap Siswa",required:""}),l(k,{id:"nama_siswa",modelValue:s(a).nama_siswa,"onUpdate:modelValue":e[0]||(e[0]=r=>s(a).nama_siswa=r),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:s(a).errors.nama_siswa,class:"mt-2"},null,8,["message"])]),t("div",null,[l(p,{for:"tanggal_lahir",value:"Tanggal Lahir",required:""}),l(k,{id:"tanggal_lahir",modelValue:s(a).tanggal_lahir,"onUpdate:modelValue":e[1]||(e[1]=r=>s(a).tanggal_lahir=r),type:"date",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:s(a).errors.tanggal_lahir,class:"mt-2"},null,8,["message"])]),t("div",null,[l(p,{for:"id_kelas",value:"Pilih Cabang Soccer School",required:""}),Q(t("select",{id:"id_kelas","onUpdate:modelValue":e[2]||(e[2]=r=>s(a).id_kelas=r),class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 rounded-md shadow-sm",required:""},[e[12]||(e[12]=t("option",{value:"",disabled:""},"-- Pilih Cabang --",-1)),(o(!0),n(N,null,X(d.allKelas,r=>(o(),n("option",{key:r.id_kelas,value:r.id_kelas},u(r.nama_kelas),9,ne))),128))],512),[[Y,s(a).id_kelas]]),l(c,{message:s(a).errors.id_kelas,class:"mt-2"},null,8,["message"])])])]),t("fieldset",null,[e[14]||(e[14]=t("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"2. Data Wali & Akun Login",-1)),t("div",ie,[t("div",null,[l(p,{for:"user_name",value:"Nama Lengkap Wali",required:""}),l(k,{id:"user_name",modelValue:s(a).user_name,"onUpdate:modelValue":e[3]||(e[3]=r=>s(a).user_name=r),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:s(a).errors.user_name,class:"mt-2"},null,8,["message"])]),t("div",null,[l(p,{for:"nomor_telepon_wali",value:"Nomor WhatsApp Wali",required:""}),l(k,{id:"nomor_telepon_wali",modelValue:s(a).nomor_telepon_wali,"onUpdate:modelValue":e[4]||(e[4]=r=>s(a).nomor_telepon_wali=r),type:"tel",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:s(a).errors.nomor_telepon_wali,class:"mt-2"},null,8,["message"])]),t("div",de,[l(p,{for:"email_wali",value:"Alamat Email Wali (untuk login)",required:""}),l(k,{id:"email_wali",modelValue:s(a).email_wali,"onUpdate:modelValue":e[5]||(e[5]=r=>s(a).email_wali=r),type:"email",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:s(a).errors.email_wali,class:"mt-2"},null,8,["message"])]),t("div",null,[l(p,{for:"user_password",value:"Buat Password",required:""}),l(k,{id:"user_password",modelValue:s(a).user_password,"onUpdate:modelValue":e[6]||(e[6]=r=>s(a).user_password=r),type:"password",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:s(a).errors.user_password,class:"mt-2"},null,8,["message"])]),t("div",null,[l(p,{for:"user_password_confirmation",value:"Konfirmasi Password",required:""}),l(k,{id:"user_password_confirmation",modelValue:s(a).user_password_confirmation,"onUpdate:modelValue":e[7]||(e[7]=r=>s(a).user_password_confirmation=r),type:"password",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),l(c,{message:s(a).errors.user_password_confirmation,class:"mt-2"},null,8,["message"])])])]),s(a).id_kelas?(o(),n("fieldset",ue,[e[18]||(e[18]=t("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"3. Biaya Pendaftaran",-1)),t("div",me,[t("div",ge,[e[15]||(e[15]=t("span",null,"Biaya Pendaftaran Normal",-1)),t("span",{class:P({"line-through text-gray-500":S.value>0||T.value>0})},u(D(q.value)),3)]),S.value>0?(o(),n("div",pe,[e[16]||(e[16]=t("span",null,"Diskon Pendaftaran",-1)),t("span",null,"- "+u(D(S.value)),1)])):g("",!0),T.value>0?(o(),n("div",ce,[t("span",null,u(v.value.name),1),t("span",null,"- "+u(D(T.value)),1)])):g("",!0),t("div",fe,[e[17]||(e[17]=t("span",null,"Total Biaya",-1)),t("span",ye,u(D(w.value)),1)]),t("div",ve,[l(p,{for:"kode_promo",value:"Punya Kode Promo?"}),t("div",_e,[l(k,{id:"kode_promo",modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=r=>f.value=r),type:"text",class:"block w-full",placeholder:"Masukkan kode di sini",disabled:!!v.value},null,8,["modelValue","disabled"]),v.value?(o(),n("button",{key:1,onClick:z,type:"button",class:"text-sm font-medium text-red-600 hover:text-red-500"},"Hapus")):(o(),Z(U,{key:0,onClick:W,disabled:C.value,type:"button"},{default:x(()=>[C.value?(o(),n("span",xe,"...")):(o(),n("span",ke,"Terapkan"))]),_:1},8,["disabled"]))]),y.value.text?(o(),n("p",{key:0,class:P(["mt-2 text-sm",y.value.type==="success"?"text-green-600":"text-red-600"])},u(y.value.text),3)):g("",!0)])])])):g("",!0),t("fieldset",null,[e[21]||(e[21]=t("legend",{class:"text-lg font-medium text-gray-900 dark:text-white"},"4. Persetujuan",-1)),t("div",we,[t("div",{onClick:E,class:"flex items-center cursor-pointer group"},[t("div",{class:P(["h-4 w-4 rounded border flex items-center justify-center transition-all",s(a).terms?"bg-red-600 border-red-700":"bg-gray-200 dark:bg-gray-900 border-gray-300 dark:border-gray-600 group-hover:border-red-500"])},[s(a).terms?(o(),n("svg",be,e[19]||(e[19]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"},null,-1)]))):g("",!0)],2),e[20]||(e[20]=t("span",{class:"ml-3 text-sm text-gray-600 dark:text-gray-400"},[V(" Saya menyetujui "),t("button",{type:"button",class:"font-medium text-red-600 hover:underline"},"syarat dan ketentuan"),V(" yang berlaku. ")],-1))]),l(c,{message:s(a).errors.terms||s(a).errors.legal_document_id,class:"mt-2"},null,8,["message"])])]),t("div",he,[l(L,{class:P(["w-full justify-center text-lg",{"opacity-50 cursor-not-allowed":!s(a).terms}]),disabled:s(a).processing||!s(a).terms},{default:x(()=>[s(a).processing?(o(),n("span",Ve,"Menyimpan...")):(o(),n("span",Ce,"Daftar & Lanjutkan Pembayaran"))]),_:1},8,["disabled","class"])])],32))]}),_:1}),l(te,{show:h.value,onClose:e[10]||(e[10]=m=>h.value=!1),maxWidth:"2xl"},{default:x(()=>[t("div",De,[e[24]||(e[24]=t("h2",{class:"text-xl font-bold text-gray-900 dark:text-white"},"Syarat dan Ketentuan",-1)),d.termsDocument?(o(),n("div",je,u(d.termsDocument.name)+" (v"+u(d.termsDocument.version)+")",1)):g("",!0),d.termsDocument?(o(),n("div",{key:1,class:"mt-4 prose prose-sm max-w-none text-gray-600 dark:text-gray-300 overflow-y-auto max-h-[60vh]",innerHTML:d.termsDocument.content},null,8,Pe)):(o(),n("div",qe,"Gagal memuat Syarat & Ketentuan.")),t("div",Se,[l(U,{onClick:e[9]||(e[9]=m=>h.value=!1)},{default:x(()=>e[22]||(e[22]=[V("Tidak Setuju")])),_:1,__:[22]}),l(L,{onClick:F,class:"bg-red-600 hover:bg-red-700 focus:ring-red-500",disabled:!d.termsDocument},{default:x(()=>e[23]||(e[23]=[V("Setuju")])),_:1,__:[23]},8,["disabled"])])])]),_:1},8,["show"])],64))}};export{$e as default};
